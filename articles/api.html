<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="eia">
<title>API details â€¢ eia</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="API details">
<meta property="og:description" content="eia">
<meta property="og:image" content="https://docs.ropensci.org/eia/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">eia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/eia.html">Get Started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/api.html">API details</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/eia">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>API details</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/eia/blob/HEAD/vignettes/api.Rmd" class="external-link"><code>vignettes/api.Rmd</code></a></small>
      <div class="d-none name"><code>api.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="api-key">API key<a class="anchor" aria-label="anchor" href="#api-key"></a>
</h2>
<div class="section level3">
<h3 id="register-a-key-with-eia">Register a key with EIA<a class="anchor" aria-label="anchor" href="#register-a-key-with-eia"></a>
</h3>
<p>Obtaining an API key is easy and free.</p>
<p>Pulling data from the US Energy Information Administration (EIA) API requires a registered API key. A key can be obtained at no cost <a href="https://www.eia.gov/opendata/register.php" class="external-link">here</a>.</p>
<p>A valid email and agreement to the API Terms of Service is required to obtain a key.</p>
</div>
<div class="section level3">
<h3 id="key-storage-and-retrieval">Key storage and retrieval<a class="anchor" aria-label="anchor" href="#key-storage-and-retrieval"></a>
</h3>
<p>It is important to store your API key somewhere secure. Do not commit it to a repository or otherwise share it. For example, you can store it in your <code>.Renviron</code> file. This is the recommended method for simplicity and persistent availability. If you do this, you do not have to do anything else. Other approaches that allow for emphemeral storage or overriding a default key with another key are outlined below.</p>
<p>You can always provide the <code>key</code> argument to every API function call, but you do not have to. There are environmental getter and setter functions available. Whichever method you use to set your key environmentally, <code>eia</code> API functions can get the key implicitly.</p>
<p><code><a href="../reference/eia_key.html">eia_set_key()</a></code> gives you the option of storing your key in any of three places via the <code>store</code> argument:</p>
<ul>
<li>
<code>store = "env"</code>: the package environment that is created when the package is loaded (default method)</li>
<li>
<code>store = "options"</code>: in the global <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code>
</li>
<li>
<code>store = "sysenv"</code>: as a system environment variable via <code><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv()</a></code>.</li>
</ul>
<p>The last two options require the name-value pair to be named <code>EIA_KEY = "yourkey"</code>. These three options also are the order of precedence if you do not specify the <code>store</code> argument.</p>
<p>This setup also allows you to store a key that will override another key. This is because <code><a href="../reference/eia_key.html">eia_get_key()</a></code> checks these three storage methods in this order and stops as soon as it finds a key. If you need it to check a specific location, you can specify <code>store</code>.</p>
<p>As an example, if the key already exists in the system environment and you plan to pass <code>key</code> to functions explicitly, you could start as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/eia/">eia</a></span><span class="op">)</span></span>
<span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"EIA_KEY"</span><span class="op">)</span></span>
<span><span class="co"># or:</span></span>
<span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eia_key.html">eia_get_key</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>If you need to set it, you can do so as follows.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># eia_set_key("yourkey")</span></span>
<span><span class="co"># eia_get_key() # retrieve it</span></span></code></pre></div>
<p>API functions in <code>eia</code> use <code><a href="../reference/eia_key.html">eia_get_key()</a></code> with no arguments as the default value of their <code>key</code> argument, checking in the order shown above for an existing key. This way you do not need to repeatedly provide it.</p>
<p>Note that despite the name and behavior, storing an environment variable with <code><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv()</a></code> (and thus <code>eia_set_key(key, store = "sysenv")</code>) is not persistent; the key is lost when the R session terminates, just as it is with the other two session-based options. If you want a persistent key, you must manually add your key somewhere like <code>.Renviron</code>. In that cases, you never need <code><a href="../reference/eia_key.html">eia_set_key()</a></code> and <code><a href="../reference/eia_key.html">eia_get_key()</a></code> will retrieve the <code>EIA_KEY</code> environment variable. See the package documentation for more details on key options.</p>
<p>In this and subsequent vignettes, you will not see a key being set because it is already an environment variable. You will also not see it used explicitly by any functions because the default behavior is to look up the key in the environment.</p>
</div>
</div>
<div class="section level2">
<h2 id="api-requests">API requests<a class="anchor" aria-label="anchor" href="#api-requests"></a>
</h2>
<p>The EIA API can of course impose its own rate-limiting and other limitations on usage by a given API key. If you use the API improperly or otherwise violate any Terms of Service, the EIA may withdraw your API access. However, the <code>eia</code> package also helps prevent accidental overuse by having default settings that limit the potential for making unnecessary API calls. It does this in two ways, both of which allow optional configuration:</p>
<ul>
<li>caching API results in memory using session-based memoization</li>
<li>minimum delay between API calls</li>
</ul>
<p>By default the <code>eia</code> package prevents you from accidentally making too many requests too quickly, but it also offers sensible flexibility.</p>
<div class="section level3">
<h3 id="memoization">Memoization<a class="anchor" aria-label="anchor" href="#memoization"></a>
</h3>
<p>All functions in <code>eia</code> that make API calls use memoization by default. They will not make the same API call twice in one R session. A call is made once and the result is cached. Calling the same function with the identical arguments again will only returned the cached result.</p>
<p>This approach limits the potential for accidentally using the EIA API more than necessary. This is fine for most uses cases. However, if you use your API key to access data that is updated very often, or you have a long-running R process such as a Shiny app on a server that may need to periodically update the data associated with a specific API call, you can set <code>cache = FALSE</code>.</p>
<p>Run this example of the same request made with and without memoization. You will notice the cached result by the immediate return.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/eia_dir.html">eia_dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># API call; cache result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/eia_dir.html">eia_dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># read from cache</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/eia_dir.html">eia_dir</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="co"># API call</span></span></code></pre></div>
<p>Results are cached in memory for the duration of the R session, but you can clear the cache at any time.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eia_clear_cache.html">eia_clear_cache</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/eia_dir.html">eia_dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This allows you to update the cached result. You can reset the cache for only specific endpoints using the following functions.</p>
<ul>
<li><code><a href="../reference/eia_clear_cache.html">eia_clear_dir()</a></code></li>
<li><code><a href="../reference/eia_clear_cache.html">eia_clear_metadata()</a></code></li>
<li><code><a href="../reference/eia_clear_cache.html">eia_clear_data()</a></code></li>
<li><code><a href="../reference/eia_clear_cache.html">eia_clear_facets()</a></code></li>
</ul>
</div>
<div class="section level3">
<h3 id="anti-dos-measures">Anti-DOS measures<a class="anchor" aria-label="anchor" href="#anti-dos-measures"></a>
</h3>
<p>Regardless of overall rate limiting imposed by the EIA API, the <code>eia</code> package sets a minimum wait time of one second between successive API calls. In most cases this is an irrelevant safeguard. Most <code>eia</code> functions make a single API call and requests for data often take a full second anyway once you factor in the subsequent data manipulation in R.</p>
<p>However, there are cases where you might want to make multiple calls back to back programmatically and perhaps you are initially unsure how many requests will be made or how quickly these requests may execute. The default minimum wait between API calls is a precaution that helps you be a good neighbor.</p>
<p>You can turn this off with <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code> if not needed; for example, a case where you know that your API calls will be small in number and you have no reason to be concerned about exceeding the request limits associated with your API key. The default requires you to make an active decision about how to use the API with your own key and API limits in mind.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
